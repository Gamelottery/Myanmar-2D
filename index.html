<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Myanmar 2D Lottery - မြန်မာ ၂လုံး ထီ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .lottery-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .wave-pay-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            transition: all 0.3s ease;
        }
        .wave-pay-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(238, 90, 36, 0.3);
        }
        .bet-card {
            transition: all 0.2s ease;
            border: 2px solid transparent;
        }
        .bet-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        .animate-bounce-slow {
            animation: bounce 2s infinite;
        }
        .upload-area {
            border: 2px dashed #d1d5db;
            transition: all 0.3s ease;
        }
        .upload-area:hover {
            border-color: #3b82f6;
            background-color: #f8fafc;
        }
        .upload-area.dragover {
            border-color: #10b981;
            background-color: #ecfdf5;
        }
    </style>
</head>
<body class="lottery-bg min-h-screen">
    <!-- Login Screen -->
    <div id="loginScreen" class="min-h-screen flex items-center justify-center px-4">
        <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full overflow-hidden">
            <!-- Login Header -->
            <div class="bg-gradient-to-r from-purple-600 to-blue-600 p-6 text-white text-center">
                <div class="text-4xl mb-2">🎰</div>
                <h1 class="text-2xl font-bold mb-1">Myanmar 2D Lottery</h1>
                <p class="opacity-90">မြန်မာ ၂လုံး ထီ</p>
            </div>
            
            <!-- Login Form -->
            <div class="p-6">
                <h2 class="text-xl font-bold text-gray-800 mb-6 text-center">🔐 အကောင့်ဝင်ရောက်ရန်</h2>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">📱 ဖုန်းနံပါတ်</label>
                        <input type="tel" id="loginPhone" placeholder="09xxxxxxxxx" 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 text-lg">
                        <p class="text-xs text-gray-500 mt-1">ဥပမာ: 09123456789</p>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">🔑 လျှို့ဝှက်နံပါတ်</label>
                        <div class="relative">
                            <input type="password" id="loginPassword" placeholder="လျှို့ဝှက်နံပါတ် ထည့်ပါ" 
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 text-lg pr-12">
                            <button type="button" id="togglePassword" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700">
                                👁️
                            </button>
                        </div>
                    </div>
                    
                    <button id="loginBtn" class="w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white font-bold py-3 px-6 rounded-lg transition-all transform hover:scale-105">
                        🚀 ဝင်ရောက်မည်
                    </button>
                </div>
                
                <div class="mt-6 text-center">
                    <p class="text-sm text-gray-600 mb-3">အကောင့်မရှိသေးဘူးလား?</p>
                    <button id="showRegisterBtn" class="text-purple-600 hover:text-purple-800 font-medium underline">
                        📝 အကောင့်အသစ်ဖွင့်ရန်
                    </button>
                </div>
                
                <!-- Demo Accounts -->
                <div class="mt-6 bg-yellow-50 rounded-lg p-4">
                    <h3 class="text-sm font-bold text-yellow-800 mb-2">🎯 စမ်းသုံးရန် အကောင့်များ</h3>
                    <div class="text-xs text-yellow-700 space-y-1">
                        <p><strong>User:</strong> 09123456789 / password: 123456</p>
                        <p><strong>VIP:</strong> 09987654321 / password: vip123</p>
                        <p><strong>Admin:</strong> 09750397287 / password: admin123</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Register Screen -->
    <div id="registerScreen" class="min-h-screen flex items-center justify-center px-4 hidden">
        <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full overflow-hidden">
            <!-- Register Header -->
            <div class="bg-gradient-to-r from-green-600 to-emerald-600 p-6 text-white text-center">
                <div class="text-4xl mb-2">📝</div>
                <h1 class="text-2xl font-bold mb-1">အကောင့်အသစ်ဖွင့်ရန်</h1>
                <p class="opacity-90">New Account Registration</p>
            </div>
            
            <!-- Register Form -->
            <div class="p-6">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">👤 အမည်</label>
                        <input type="text" id="registerName" placeholder="သင့်အမည် ထည့်ပါ" 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-lg">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">📱 ဖုန်းနံပါတ်</label>
                        <input type="tel" id="registerPhone" placeholder="09xxxxxxxxx" 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-lg">
                        <p class="text-xs text-gray-500 mt-1">ဥပမာ: 09123456789</p>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">🔑 လျှို့ဝှက်နံပါတ်</label>
                        <input type="password" id="registerPassword" placeholder="အနည်းဆုံး ၆ လုံး" 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-lg">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">🔑 လျှို့ဝှက်နံပါတ် အတည်ပြုရန်</label>
                        <input type="password" id="confirmPassword" placeholder="လျှို့ဝှက်နံပါတ် ပြန်ထည့်ပါ" 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-lg">
                    </div>
                    
                    <button id="registerBtn" class="w-full bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white font-bold py-3 px-6 rounded-lg transition-all transform hover:scale-105">
                        ✅ အကောင့်ဖွင့်မည်
                    </button>
                </div>
                
                <div class="mt-6 text-center">
                    <button id="showLoginBtn" class="text-green-600 hover:text-green-800 font-medium underline">
                        ⬅️ အကောင့်ဝင်ရောက်ရန် ပြန်သွားမည်
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App (Hidden by default) -->
    <div id="mainApp" class="container mx-auto px-4 py-8 hidden">
        <!-- Header with User Profile -->
        <div class="bg-white rounded-2xl shadow-2xl mb-8 overflow-hidden">
            <div class="bg-gradient-to-r from-purple-600 to-blue-600 p-4">
                <div class="flex justify-between items-center">
                    <div class="flex items-center gap-3">
                        <div class="bg-white bg-opacity-20 rounded-full p-2">
                            <span class="text-2xl">👤</span>
                        </div>
                        <div class="text-white">
                            <div class="font-bold text-lg" id="userDisplayName">Loading...</div>
                            <div class="text-sm opacity-90" id="userDisplayPhone">Loading...</div>
                        </div>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="text-white text-right">
                            <div class="text-xs opacity-75">လက်ကျန်ငွေ</div>
                            <div class="font-bold text-lg" id="userBalance">0 ကျပ်</div>
                        </div>
                        <button id="logoutBtn" class="bg-white bg-opacity-20 hover:bg-opacity-30 text-white p-2 rounded-lg transition-colors">
                            🚪
                        </button>
                    </div>
                </div>
            </div>
            <div class="text-center py-4">
                <h1 class="text-2xl font-bold text-gray-800 mb-1">🎰 Myanmar 2D Lottery</h1>
                <p class="text-gray-600">မြန်မာ ၂လုံး ထီ - ကံကောင်းပါစေ! 🍀</p>
            </div>
        </div>

        <!-- Lottery Results Display -->
        <div class="max-w-4xl mx-auto mb-8">
            <div class="bg-white rounded-2xl shadow-2xl overflow-hidden">
                <div class="bg-gradient-to-r from-yellow-500 to-orange-500 p-4 text-white text-center">
                    <h2 class="text-2xl font-bold mb-1">🏆 ယနေ့ ထီရလဒ်များ</h2>
                    <p class="opacity-90" id="currentDate">Loading...</p>
                </div>
                
                <div class="p-6">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <!-- 9:30 AM Draw -->
                        <div class="text-center">
                            <div class="bg-blue-50 rounded-lg p-4">
                                <div class="text-lg font-bold text-blue-800 mb-2">🌅 မနက် 9:30</div>
                                <div class="bg-white rounded-lg p-4 shadow-inner">
                                    <div id="result930" class="text-3xl font-bold text-gray-400">မထွက်သေး</div>
                                </div>
                                <div class="text-xs text-gray-500 mt-2">Morning Draw</div>
                            </div>
                        </div>
                        
                        <!-- 2:00 PM Draw -->
                        <div class="text-center">
                            <div class="bg-green-50 rounded-lg p-4">
                                <div class="text-lg font-bold text-green-800 mb-2">☀️ နေ့လည် 2:00</div>
                                <div class="bg-white rounded-lg p-4 shadow-inner">
                                    <div id="result200" class="text-3xl font-bold text-gray-400">မထွက်သေး</div>
                                </div>
                                <div class="text-xs text-gray-500 mt-2">Afternoon Draw</div>
                            </div>
                        </div>
                        
                        <!-- 4:30 PM Draw -->
                        <div class="text-center">
                            <div class="bg-purple-50 rounded-lg p-4">
                                <div class="text-lg font-bold text-purple-800 mb-2">🌆 ညနေ 4:30</div>
                                <div class="bg-white rounded-lg p-4 shadow-inner">
                                    <div id="result430" class="text-3xl font-bold text-gray-400">မထွက်သေး</div>
                                </div>
                                <div class="text-xs text-gray-500 mt-2">Evening Draw</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Next Draw Countdown -->
                    <div class="mt-6 text-center">
                        <div class="bg-gray-100 rounded-lg p-4">
                            <div class="text-sm text-gray-600 mb-1">နောက်ထီ ထွက်ချိန်</div>
                            <div id="nextDrawTime" class="text-lg font-bold text-orange-600">Loading...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Game Area -->
        <div class="max-w-2xl mx-auto bg-white rounded-2xl shadow-2xl overflow-hidden">
            <!-- Game Header -->
            <div class="bg-gradient-to-r from-purple-600 to-blue-600 p-6 text-white text-center">
                <h2 class="text-2xl font-bold mb-2">🎯 ထီထိုးရန်</h2>
                <p class="opacity-90">နံပါတ်နှင့် ငွေပမာဏ ထည့်သွင်းပါ</p>
            </div>

            <!-- Number Entry Form -->
            <div class="p-6">
                <div class="bg-gray-50 rounded-lg p-4 mb-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">🎫 ထီထိုးရန် ထည့်သွင်းပါ</h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">နံပါတ်</label>
                            <input type="text" id="numberInput" placeholder="ဥပမာ: 23" maxlength="2" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 text-center text-xl font-bold">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">ငွေပမာဏ (ကျပ်)</label>
                            <input type="number" id="amountInput" placeholder="100" min="100" step="100"
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 text-center text-lg font-bold">
                        </div>
                        <div class="flex items-end">
                            <button id="addBetBtn" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition-colors">
                                ➕ ထည့်မည်
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Bet List -->
                <div class="mb-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">📋 ထိုးထားသော ထီများ</h3>
                    <div id="betList" class="space-y-3 min-h-[100px]">
                        <div class="text-center text-gray-500 py-8">
                            <p>ထီမထိုးရသေးပါ</p>
                            <p class="text-sm">နံပါတ်နှင့် ငွေပမာဏ ထည့်ပြီး ထည့်မည် ကိုနှိပ်ပါ</p>
                        </div>
                    </div>
                </div>

                <!-- Total Amount -->
                <div class="bg-yellow-100 rounded-lg p-4 mb-6">
                    <div class="flex justify-between items-center">
                        <span class="text-lg font-bold text-gray-800">💵 စုစုပေါင်း</span>
                        <span id="totalAmount" class="text-2xl font-bold text-green-600">0 ကျပ်</span>
                    </div>
                </div>

                <!-- Payment Button -->
                <button id="payNowBtn" class="w-full wave-pay-btn text-white font-bold py-4 px-6 rounded-xl text-lg disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                    🚀 Wave Pay ဖြင့် ပေးချေမည်
                </button>
            </div>
        </div>

        <!-- Wave Pay Transfer Modal -->
        <div id="wavePayModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white rounded-2xl max-w-md mx-4 overflow-hidden">
                <!-- Wave Pay Header -->
                <div class="bg-gradient-to-r from-red-500 to-pink-500 p-4 text-white">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-2">
                            <span class="text-2xl">📱</span>
                            <span class="font-bold text-lg">Wave Pay လွှဲပြောင်းမှု</span>
                        </div>
                        <button id="closeWaveModal" class="text-white text-xl">✕</button>
                    </div>
                </div>
                
                <!-- Transfer Instructions -->
                <div class="p-6">
                    <div class="text-center mb-6">
                        <div class="text-4xl mb-3">💰</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">ငွေလွှဲပြောင်းရန်</h3>
                        <div class="bg-gray-100 rounded-lg p-4 mb-4">
                            <div class="text-sm text-gray-600 mb-1">လွှဲရမည့်ငွေ</div>
                            <div id="transferAmount" class="text-2xl font-bold text-red-500">0 ကျပ်</div>
                        </div>
                    </div>
                    
                    <!-- Transfer Details -->
                    <div class="bg-blue-50 rounded-lg p-4 mb-6">
                        <h4 class="font-bold text-gray-800 mb-2">📞 လွှဲရမည့် အကောင့်</h4>
                        <div class="space-y-1 text-sm">
                            <p><span class="font-medium">ဖုန်းနံပါတ်:</span> 09750397287</p>
                            <p><span class="font-medium">အမည်:</span> Khant Lwin Moe</p>
                        </div>
                    </div>

                    <!-- Sender Phone Number -->
                    <div class="mb-4">
                        <h4 class="font-bold text-gray-800 mb-2">📱 လွှဲသူ ဖုန်းနံပါတ်</h4>
                        <input type="text" id="senderPhone" placeholder="ဥပမာ: 09123456789" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500">
                        <p class="text-xs text-gray-500 mt-1">Wave Pay မှ လွှဲသော ဖုန်းနံပါတ် ထည့်ပါ</p>
                    </div>

                    <!-- Upload Receipt -->
                    <div class="mb-6">
                        <h4 class="font-bold text-gray-800 mb-3">📸 ငွေလွှဲပြေစာ တင်ပါ</h4>
                        <div id="uploadArea" class="upload-area rounded-lg p-6 text-center cursor-pointer">
                            <div id="uploadContent">
                                <div class="text-4xl mb-2">📤</div>
                                <p class="text-gray-600 mb-1">ပြေစာပုံ တင်ရန် နှိပ်ပါ</p>
                                <p class="text-xs text-gray-500">PNG, JPG ဖိုင်များ လက်ခံပါသည်</p>
                            </div>
                            <div id="uploadedImage" class="hidden">
                                <img id="receiptImage" class="max-w-full h-32 object-cover rounded mx-auto mb-2">
                                <p class="text-green-600 font-medium">✅ ပြေစာ တင်ပြီးပါပြီ</p>
                            </div>
                        </div>
                        <input type="file" id="fileInput" accept="image/*" class="hidden">
                    </div>
                    
                    <div class="space-y-3">
                        <button id="submitPayment" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                            ✅ လုပ်ဆောင်မည်
                        </button>
                        <button id="cancelPayment" class="w-full bg-gray-300 hover:bg-gray-400 text-gray-700 font-bold py-3 px-6 rounded-lg transition-colors">
                            ❌ ပယ်ဖျက်မည်
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- History Modal -->
        <div id="historyModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white rounded-2xl max-w-md mx-4 overflow-hidden">
                <div class="bg-gradient-to-r from-blue-500 to-purple-500 p-4 text-white text-center">
                    <h3 class="text-xl font-bold">📊 ထီထိုးမှု မှတ်တမ်း</h3>
                </div>
                
                <div class="p-6">
                    <div id="historyContent" class="space-y-4">
                        <!-- History items will be added here -->
                    </div>
                    
                    <button id="closeHistory" class="w-full bg-gray-300 hover:bg-gray-400 text-gray-700 font-bold py-3 px-6 rounded-lg transition-colors mt-4">
                        ပိတ်မည်
                    </button>
                </div>
            </div>
        </div>

        <!-- Admin Panel Modal -->
        <div id="adminModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white rounded-2xl max-w-md mx-4 overflow-hidden">
                <div class="bg-gradient-to-r from-green-500 to-emerald-500 p-4 text-white text-center">
                    <h3 class="text-xl font-bold">🔐 Admin Panel</h3>
                </div>
                
                <div class="p-6">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Admin Password</label>
                        <input type="password" id="adminPassword" placeholder="Enter admin password" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                    </div>
                    
                    <div class="space-y-3">
                        <button id="loginAdmin" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg transition-colors">
                            🔓 Login
                        </button>
                        <button id="closeAdmin" class="w-full bg-gray-300 hover:bg-gray-400 text-gray-700 font-bold py-3 px-6 rounded-lg transition-colors">
                            ❌ Cancel
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Admin History Modal -->
        <div id="adminHistoryModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white rounded-2xl max-w-2xl mx-4 overflow-hidden">
                <div class="bg-gradient-to-r from-green-500 to-emerald-500 p-4 text-white">
                    <div class="flex items-center justify-between">
                        <h3 class="text-xl font-bold">👑 Admin Panel</h3>
                        <button id="closeAdminHistory" class="text-white text-xl">✕</button>
                    </div>
                </div>
                
                <div class="p-6 max-h-96 overflow-y-auto">
                    <!-- Lottery Results Control -->
                    <div class="mb-6 bg-yellow-50 rounded-lg p-4">
                        <h4 class="text-lg font-bold text-gray-800 mb-4">🎰 ထီရလဒ် ထိန်းချုပ်မှု</h4>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                            <!-- 9:30 AM Control -->
                            <div class="text-center">
                                <div class="text-sm font-medium text-blue-800 mb-2">မနက် 9:30</div>
                                <input type="text" id="admin930" placeholder="00-99" maxlength="2" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-center text-lg font-bold">
                                <button onclick="setLotteryResult('09:30', 'admin930')" 
                                        class="w-full mt-2 bg-blue-500 hover:bg-blue-600 text-white font-bold py-1 px-2 rounded text-sm transition-colors">
                                    Set Result
                                </button>
                            </div>
                            
                            <!-- 2:00 PM Control -->
                            <div class="text-center">
                                <div class="text-sm font-medium text-green-800 mb-2">နေ့လည် 2:00</div>
                                <input type="text" id="admin200" placeholder="00-99" maxlength="2" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-center text-lg font-bold">
                                <button onclick="setLotteryResult('14:00', 'admin200')" 
                                        class="w-full mt-2 bg-green-500 hover:bg-green-600 text-white font-bold py-1 px-2 rounded text-sm transition-colors">
                                    Set Result
                                </button>
                            </div>
                            
                            <!-- 4:30 PM Control -->
                            <div class="text-center">
                                <div class="text-sm font-medium text-purple-800 mb-2">ညနေ 4:30</div>
                                <input type="text" id="admin430" placeholder="00-99" maxlength="2" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 text-center text-lg font-bold">
                                <button onclick="setLotteryResult('16:30', 'admin430')" 
                                        class="w-full mt-2 bg-purple-500 hover:bg-purple-600 text-white font-bold py-1 px-2 rounded text-sm transition-colors">
                                    Set Result
                                </button>
                            </div>
                        </div>
                        
                        <div class="text-center">
                            <button onclick="clearAllResults()" 
                                    class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded transition-colors">
                                🗑️ Clear All Results
                            </button>
                        </div>
                    </div>
                    
                    <!-- Pending Approvals -->
                    <div class="bg-blue-50 rounded-lg p-4">
                        <h4 class="text-lg font-bold text-gray-800 mb-4">📋 Pending Approvals</h4>
                        <div id="adminHistoryContent" class="space-y-4">
                            <!-- Admin history items will be added here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Floating Buttons -->
        <div class="fixed bottom-6 right-6 space-y-3">
            <button id="historyBtn" class="bg-blue-500 hover:bg-blue-600 text-white p-4 rounded-full shadow-lg transition-colors block">
                📊
            </button>
            <button id="adminBtn" class="bg-green-500 hover:bg-green-600 text-white p-4 rounded-full shadow-lg transition-colors block">
                👑
            </button>
        </div>
    </div>

    <script>
        // User Authentication System
        let currentUser = null;
        let users = [
            { phone: '09123456789', password: '123456', name: 'Mg Mg', balance: 50000, type: 'user' },
            { phone: '09987654321', password: 'vip123', name: 'Daw Aye', balance: 100000, type: 'vip' },
            { phone: '09750397287', password: 'admin123', name: 'Admin', balance: 999999, type: 'admin' }
        ];

        // Game state
        let betList = [];
        let totalAmount = 0;
        let history = [];

        // Authentication Functions
        function validatePhone(phone) {
            const phoneRegex = /^09\d{7,9}$/;
            return phoneRegex.test(phone);
        }

        function validatePassword(password) {
            return password.length >= 6;
        }

        function findUser(phone, password) {
            return users.find(user => user.phone === phone && user.password === password);
        }

        function registerUser(name, phone, password) {
            // Check if user already exists
            if (users.find(user => user.phone === phone)) {
                return { success: false, message: 'ဤဖုန်းနံပါတ်ဖြင့် အကောင့်ရှိပြီးပါပြီ' };
            }

            // Create new user
            const newUser = {
                phone: phone,
                password: password,
                name: name,
                balance: 0, // Starting balance - no money for new users
                type: 'user'
            };

            users.push(newUser);
            return { success: true, message: 'အကောင့်ဖွင့်ခြင်း အောင်မြင်ပါသည်!' };
        }

        function login(phone, password) {
            const user = findUser(phone, password);
            if (user) {
                currentUser = user;
                showMainApp();
                updateUserDisplay();
                return { success: true, message: 'အကောင့်ဝင်ရောက်ခြင်း အောင်မြင်ပါသည်!' };
            } else {
                return { success: false, message: 'ဖုန်းနံပါတ် သို့မဟုတ် လျှို့ဝှက်နံပါတ် မမှန်ကန်ပါ' };
            }
        }

        function logout() {
            currentUser = null;
            showLoginScreen();
            // Reset game state
            betList = [];
            totalAmount = 0;
            updateBetDisplay();
            updateTotal();
            updatePayButton();
        }

        function showLoginScreen() {
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('registerScreen').classList.add('hidden');
            document.getElementById('mainApp').classList.add('hidden');
        }

        function showRegisterScreen() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('registerScreen').classList.remove('hidden');
            document.getElementById('mainApp').classList.add('hidden');
        }

        function showMainApp() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('registerScreen').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
        }

        function updateUserDisplay() {
            if (currentUser) {
                document.getElementById('userDisplayName').textContent = currentUser.name;
                document.getElementById('userDisplayPhone').textContent = currentUser.phone;
                document.getElementById('userBalance').textContent = currentUser.balance.toLocaleString() + ' ကျပ်';
                
                // Show/hide admin button based on user type
                const adminBtn = document.getElementById('adminBtn');
                if (currentUser.type === 'admin') {
                    adminBtn.style.display = 'block';
                } else {
                    adminBtn.style.display = 'none';
                }
            }
        }

        // Login/Register Event Listeners
        document.getElementById('loginBtn').addEventListener('click', function() {
            const phone = document.getElementById('loginPhone').value.trim();
            const password = document.getElementById('loginPassword').value.trim();

            if (!phone || !password) {
                alert('ဖုန်းနံပါတ်နှင့် လျှို့ဝှက်နံပါတ် ထည့်ပါ');
                return;
            }

            if (!validatePhone(phone)) {
                alert('ဖုန်းနံပါတ် မှန်ကန်စွာ ထည့်ပါ (ဥပမာ: 09123456789)');
                return;
            }

            const result = login(phone, password);
            alert(result.message);

            if (result.success) {
                // Clear login form
                document.getElementById('loginPhone').value = '';
                document.getElementById('loginPassword').value = '';
            }
        });

        document.getElementById('registerBtn').addEventListener('click', function() {
            const name = document.getElementById('registerName').value.trim();
            const phone = document.getElementById('registerPhone').value.trim();
            const password = document.getElementById('registerPassword').value.trim();
            const confirmPassword = document.getElementById('confirmPassword').value.trim();

            if (!name || !phone || !password || !confirmPassword) {
                alert('အချက်အလက်များ အားလုံး ထည့်ပါ');
                return;
            }

            if (!validatePhone(phone)) {
                alert('ဖုန်းနံပါတ် မှန်ကန်စွာ ထည့်ပါ (ဥပမာ: 09123456789)');
                return;
            }

            if (!validatePassword(password)) {
                alert('လျှို့ဝှက်နံပါတ် အနည်းဆုံး ၆ လုံး ရှိရမည်');
                return;
            }

            if (password !== confirmPassword) {
                alert('လျှို့ဝှက်နံပါတ်များ မတူညီပါ');
                return;
            }

            const result = registerUser(name, phone, password);
            
            if (result.success) {
                alert(`${result.message}\n\n⚠️ အကောင့်အသစ်များ လက်ကျန်ငွေ 0 ကျပ်ဖြင့် စတင်ပါသည်။\nထီထိုးရန် ငွေဖြည့်သွင်းပါ။\n\nအကောင့်ဝင်ရောက်ရန် Login စာမျက်နှာသို့ သွားပါ။`);
                
                // Clear register form
                document.getElementById('registerName').value = '';
                document.getElementById('registerPhone').value = '';
                document.getElementById('registerPassword').value = '';
                document.getElementById('confirmPassword').value = '';
                
                // Go back to login screen instead of auto-login
                showLoginScreen();
            } else {
                alert(result.message);
            }
        });

        document.getElementById('showRegisterBtn').addEventListener('click', showRegisterScreen);
        document.getElementById('showLoginBtn').addEventListener('click', showLoginScreen);
        document.getElementById('logoutBtn').addEventListener('click', function() {
            if (confirm('အကောင့်မှ ထွက်မှာ သေချာပါသလား?')) {
                logout();
            }
        });

        // Password toggle
        document.getElementById('togglePassword').addEventListener('click', function() {
            const passwordInput = document.getElementById('loginPassword');
            const toggleBtn = document.getElementById('togglePassword');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleBtn.textContent = '🙈';
            } else {
                passwordInput.type = 'password';
                toggleBtn.textContent = '👁️';
            }
        });

        // Enter key support for login
        document.getElementById('loginPhone').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('loginPassword').focus();
            }
        });

        document.getElementById('loginPassword').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('loginBtn').click();
            }
        });

        // Enter key support for register
        document.getElementById('registerName').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('registerPhone').focus();
            }
        });

        document.getElementById('registerPhone').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('registerPassword').focus();
            }
        });

        document.getElementById('registerPassword').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('confirmPassword').focus();
            }
        });

        document.getElementById('confirmPassword').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('registerBtn').click();
            }
        });

        // Add bet function
        function addBet() {
            const numberInput = document.getElementById('numberInput');
            const amountInput = document.getElementById('amountInput');
            
            const number = numberInput.value.trim();
            const amount = parseInt(amountInput.value);
            
            // Validation
            if (!number || number.length !== 2 || isNaN(parseInt(number))) {
                alert('နံပါတ် ၂ လုံး ရိုက်ထည့်ပါ (ဥပမာ: 23)');
                return;
            }
            
            if (!amount || amount < 100) {
                alert('ငွေပမာဏ အနည်းဆုံး ၁၀၀ ကျပ် ထည့်ပါ');
                return;
            }
            
            // Check if number already exists
            const existingBet = betList.find(bet => bet.number === number);
            if (existingBet) {
                existingBet.amount += amount;
            } else {
                betList.push({ number, amount, id: Date.now() });
            }
            
            // Clear inputs
            numberInput.value = '';
            amountInput.value = '';
            
            updateBetDisplay();
            updateTotal();
            updatePayButton();
        }

        // Remove bet function
        function removeBet(id) {
            betList = betList.filter(bet => bet.id !== id);
            updateBetDisplay();
            updateTotal();
            updatePayButton();
        }

        // Update bet display
        function updateBetDisplay() {
            const container = document.getElementById('betList');
            
            if (betList.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <p>ထီမထိုးရသေးပါ</p>
                        <p class="text-sm">နံပါတ်နှင့် ငွေပမာဏ ထည့်ပြီး ထည့်မည် ကိုနှိပ်ပါ</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = betList.map(bet => `
                <div class="bet-card bg-white border rounded-lg p-4 flex justify-between items-center">
                    <div class="flex items-center gap-4">
                        <div class="bg-blue-500 text-white w-12 h-12 rounded-full flex items-center justify-center font-bold text-lg">
                            ${bet.number}
                        </div>
                        <div>
                            <div class="font-bold text-gray-800">${bet.amount.toLocaleString()} ကျပ်</div>
                            <div class="text-sm text-gray-600">နံပါတ် ${bet.number}</div>
                        </div>
                    </div>
                    <button onclick="removeBet(${bet.id})" class="text-red-500 hover:text-red-700 text-xl">
                        🗑️
                    </button>
                </div>
            `).join('');
        }

        // Update total
        function updateTotal() {
            totalAmount = betList.reduce((sum, bet) => sum + bet.amount, 0);
            document.getElementById('totalAmount').textContent = totalAmount.toLocaleString() + ' ကျပ်';
        }

        // Update pay button
        function updatePayButton() {
            const payBtn = document.getElementById('payNowBtn');
            payBtn.disabled = betList.length === 0;
        }

        // File upload handling
        function setupFileUpload() {
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');
            const uploadContent = document.getElementById('uploadContent');
            const uploadedImage = document.getElementById('uploadedImage');
            const receiptImage = document.getElementById('receiptImage');
            const submitBtn = document.getElementById('submitPayment');

            uploadArea.addEventListener('click', () => fileInput.click());
            
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFile(files[0]);
                }
            });

            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleFile(e.target.files[0]);
                }
            });

            function handleFile(file) {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        receiptImage.src = e.target.result;
                        uploadContent.classList.add('hidden');
                        uploadedImage.classList.remove('hidden');
                        
                        // Validate receipt (simple check based on file name or content)
                        const isValidReceipt = validateReceipt(file, e.target.result);
                        
                        if (isValidReceipt) {
                            document.getElementById('uploadedImage').innerHTML = `
                                <img id="receiptImage" src="${e.target.result}" class="max-w-full h-32 object-cover rounded mx-auto mb-2">
                                <p class="text-green-600 font-medium">✅ ပြေစာ မှန်ကန်ပါသည်</p>
                            `;
                            submitBtn.disabled = false;
                            submitBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                        } else {
                            document.getElementById('uploadedImage').innerHTML = `
                                <img id="receiptImage" src="${e.target.result}" class="max-w-full h-32 object-cover rounded mx-auto mb-2">
                                <p class="text-red-600 font-medium">❌ ပြေစာမမှန်ကန်ပါ</p>
                                <p class="text-xs text-red-500">တကယ့် Wave Pay ပြေစာ တင်ပါ</p>
                            `;
                            submitBtn.disabled = true;
                            submitBtn.classList.add('opacity-50', 'cursor-not-allowed');
                        }
                    };
                    reader.readAsDataURL(file);
                } else {
                    alert('ပုံဖိုင်များသာ လက်ခံပါသည်');
                }
            }
            
            function validateReceipt(file, dataUrl) {
                // Simple validation based on file name and basic image analysis
                const fileName = file.name.toLowerCase();
                
                // Check if filename contains wave pay related keywords
                const waveKeywords = ['wave', 'pay', 'receipt', 'transfer', 'ငွေလွှဲ', 'ပြေစာ'];
                const hasWaveKeyword = waveKeywords.some(keyword => fileName.includes(keyword));
                
                // Check file size (receipts are usually not too small)
                const isReasonableSize = file.size > 10000; // At least 10KB
                
                // For demo purposes, we'll also check if it's a screenshot (usually larger files)
                const isLikelyScreenshot = file.size > 50000; // At least 50KB
                
                // Simple validation: must have wave keyword OR be a reasonable size screenshot
                return hasWaveKeyword || (isReasonableSize && isLikelyScreenshot);
            }
        }

        // Add to history
        function addToHistory(bets, amount, status = 'လုပ်ဆောင်နေဆဲ', senderPhone = null) {
            const historyItem = {
                id: Date.now(),
                date: new Date().toLocaleString('my-MM'),
                bets: [...bets],
                amount: amount,
                status: status,
                senderPhone: senderPhone,
                user: currentUser ? {
                    name: currentUser.name,
                    phone: currentUser.phone,
                    type: currentUser.type
                } : null
            };
            history.unshift(historyItem);
            updateHistoryDisplay();
            updateAdminHistoryDisplay();
        }

        // Approve transaction
        function approveTransaction(id) {
            const item = history.find(h => h.id === id);
            if (item) {
                item.status = 'အောင်မြင်ပါသည်';
                
                // If user exists, no need to refund (already deducted)
                updateHistoryDisplay();
                updateAdminHistoryDisplay();
                
                alert(`Transaction approved for ${item.user ? item.user.name : 'Unknown User'}\nAmount: ${item.amount.toLocaleString()} ကျပ်`);
            }
        }

        // Reject transaction
        function rejectTransaction(id) {
            const item = history.find(h => h.id === id);
            if (item) {
                item.status = 'ပယ်ဖျက်ပြီး';
                
                // Refund balance to user if user exists
                if (item.user) {
                    const user = users.find(u => u.phone === item.user.phone);
                    if (user) {
                        user.balance += item.amount;
                        // Update display if it's the current user
                        if (currentUser && currentUser.phone === user.phone) {
                            currentUser.balance = user.balance;
                            updateUserDisplay();
                        }
                    }
                }
                
                updateHistoryDisplay();
                updateAdminHistoryDisplay();
                
                alert(`Transaction rejected and refunded for ${item.user ? item.user.name : 'Unknown User'}\nRefund: ${item.amount.toLocaleString()} ကျပ်`);
            }
        }

        // Update history display
        function updateHistoryDisplay() {
            const container = document.getElementById('historyContent');
            
            if (history.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-500">မှတ်တမ်းမရှိပါ</p>';
                return;
            }
            
            container.innerHTML = history.map(item => `
                <div class="border rounded-lg p-4">
                    <div class="flex justify-between items-start mb-2">
                        <div class="text-sm text-gray-600">${item.date}</div>
                        <div class="text-sm font-medium ${
                            item.status === 'လုပ်ဆောင်နေဆဲ' ? 'text-orange-600' : 
                            item.status === 'အောင်မြင်ပါသည်' ? 'text-green-600' : 'text-red-600'
                        }">
                            ${item.status}
                        </div>
                    </div>
                    <div class="mb-2">
                        <div class="text-sm text-gray-600 mb-1">ထိုးထားသော နံပါတ်များ:</div>
                        <div class="flex flex-wrap gap-1">
                            ${item.bets.map(bet => `<span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs">${bet.number} (${bet.amount}ကျပ်)</span>`).join('')}
                        </div>
                    </div>
                    <div class="text-right font-bold text-green-600">${item.amount.toLocaleString()} ကျပ်</div>
                </div>
            `).join('');
        }

        // Update admin history display
        function updateAdminHistoryDisplay() {
            const container = document.getElementById('adminHistoryContent');
            const pendingItems = history.filter(item => item.status === 'လုပ်ဆောင်နေဆဲ');
            
            if (pendingItems.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-500">Approve လုပ်ရန် မရှိပါ</p>';
                return;
            }
            
            container.innerHTML = pendingItems.map(item => `
                <div class="border rounded-lg p-4 bg-yellow-50">
                    <div class="flex justify-between items-start mb-2">
                        <div class="text-sm text-gray-600">${item.date}</div>
                        <div class="text-sm font-medium text-orange-600">
                            ${item.status}
                        </div>
                    </div>
                    ${item.user ? `
                    <div class="mb-2 bg-blue-50 rounded p-2">
                        <div class="text-sm text-gray-600">👤 အကောင့်ပိုင်ရှင်:</div>
                        <div class="text-sm font-medium text-blue-800">${item.user.name} (${item.user.phone})</div>
                        <div class="text-xs text-blue-600">${item.user.type === 'admin' ? 'Admin' : item.user.type === 'vip' ? 'VIP User' : 'Regular User'}</div>
                    </div>
                    ` : ''}
                    ${item.senderPhone ? `
                    <div class="mb-2">
                        <div class="text-sm text-gray-600">📱 လွှဲသူ ဖုန်းနံပါတ်:</div>
                        <div class="text-sm font-medium text-blue-600">${item.senderPhone}</div>
                    </div>
                    ` : ''}
                    <div class="mb-3">
                        <div class="text-sm text-gray-600 mb-1">ထိုးထားသော နံပါတ်များ:</div>
                        <div class="flex flex-wrap gap-1 mb-2">
                            ${item.bets.map(bet => `<span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs">${bet.number} (${bet.amount}ကျပ်)</span>`).join('')}
                        </div>
                        <div class="text-right font-bold text-green-600">${item.amount.toLocaleString()} ကျပ်</div>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="approveTransaction(${item.id})" class="flex-1 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded transition-colors">
                            ✅ Approve
                        </button>
                        <button onclick="rejectTransaction(${item.id})" class="flex-1 bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded transition-colors">
                            ❌ Reject
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Event listeners
        document.getElementById('addBetBtn').addEventListener('click', addBet);
        
        document.getElementById('numberInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('amountInput').focus();
            }
        });
        
        document.getElementById('amountInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addBet();
            }
        });

        document.getElementById('payNowBtn').addEventListener('click', function() {
            if (betList.length === 0) {
                alert('ထီထိုးပါ');
                return;
            }
            
            document.getElementById('transferAmount').textContent = totalAmount.toLocaleString() + ' ကျပ်';
            document.getElementById('wavePayModal').classList.remove('hidden');
            document.getElementById('wavePayModal').classList.add('flex');
        });

        document.getElementById('closeWaveModal').addEventListener('click', function() {
            document.getElementById('wavePayModal').classList.add('hidden');
            document.getElementById('wavePayModal').classList.remove('flex');
            // Reset upload
            document.getElementById('uploadContent').classList.remove('hidden');
            document.getElementById('uploadedImage').classList.add('hidden');
            document.getElementById('submitPayment').disabled = true;
            document.getElementById('submitPayment').classList.add('opacity-50', 'cursor-not-allowed');
            // Reset phone field
            document.getElementById('senderPhone').value = '';
        });

        document.getElementById('cancelPayment').addEventListener('click', function() {
            document.getElementById('wavePayModal').classList.add('hidden');
            document.getElementById('wavePayModal').classList.remove('flex');
            // Reset phone field
            document.getElementById('senderPhone').value = '';
        });

        document.getElementById('submitPayment').addEventListener('click', function() {
            // Check if user has sufficient balance
            if (!currentUser) {
                alert('အကောင့်ဝင်ရောက်ပါ');
                return;
            }

            if (currentUser.balance < totalAmount) {
                alert(`လက်ကျန်ငွေ မလုံလောက်ပါ!\nလိုအပ်သော ငွေ: ${totalAmount.toLocaleString()} ကျပ်\nလက်ကျန်ငွေ: ${currentUser.balance.toLocaleString()} ကျပ်`);
                return;
            }

            // Get sender phone number
            const senderPhone = document.getElementById('senderPhone').value.trim();
            
            if (!senderPhone) {
                alert('လွှဲသူ ဖုန်းနံပါတ် ထည့်ပါ');
                return;
            }
            
            // Show processing message
            const submitBtn = document.getElementById('submitPayment');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '⏳ လုပ်ဆောင်နေသည်...';
            submitBtn.disabled = true;
            
            // Simulate processing time
            setTimeout(() => {
                // Deduct balance
                currentUser.balance -= totalAmount;
                updateUserDisplay();
                
                // Add to history with sender phone and user info
                addToHistory(betList, totalAmount, 'လုပ်ဆောင်နေဆဲ', senderPhone);
                
                // Reset game
                betList = [];
                updateBetDisplay();
                updateTotal();
                updatePayButton();
                
                // Reset form
                document.getElementById('senderPhone').value = '';
                
                // Close modal
                document.getElementById('wavePayModal').classList.add('hidden');
                document.getElementById('wavePayModal').classList.remove('flex');
                
                // Reset submit button
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
                
                // Show success message with admin review notice
                alert(`ထီထိုးမှု အောင်မြင်ပါသည်!\n\nငွေပမာဏ: ${totalAmount.toLocaleString()} ကျပ်\nလက်ကျန်ငွေ: ${currentUser.balance.toLocaleString()} ကျပ်\n\nAdmin မှ အတည်ပြုပေးရန် စောင့်ဆိုင်းပါ။`);
            }, 2000);
        });

        document.getElementById('historyBtn').addEventListener('click', function() {
            document.getElementById('historyModal').classList.remove('hidden');
            document.getElementById('historyModal').classList.add('flex');
        });

        document.getElementById('closeHistory').addEventListener('click', function() {
            document.getElementById('historyModal').classList.add('hidden');
            document.getElementById('historyModal').classList.remove('flex');
        });

        // Admin event listeners
        document.getElementById('adminBtn').addEventListener('click', function() {
            document.getElementById('adminModal').classList.remove('hidden');
            document.getElementById('adminModal').classList.add('flex');
        });

        document.getElementById('closeAdmin').addEventListener('click', function() {
            document.getElementById('adminModal').classList.add('hidden');
            document.getElementById('adminModal').classList.remove('flex');
            document.getElementById('adminPassword').value = '';
        });

        document.getElementById('loginAdmin').addEventListener('click', function() {
            const password = document.getElementById('adminPassword').value;
            if (password === 'admin123') {
                document.getElementById('adminModal').classList.add('hidden');
                document.getElementById('adminModal').classList.remove('flex');
                document.getElementById('adminHistoryModal').classList.remove('hidden');
                document.getElementById('adminHistoryModal').classList.add('flex');
                document.getElementById('adminPassword').value = '';
            } else {
                alert('Wrong password!');
            }
        });

        document.getElementById('closeAdminHistory').addEventListener('click', function() {
            document.getElementById('adminHistoryModal').classList.add('hidden');
            document.getElementById('adminHistoryModal').classList.remove('flex');
        });

        document.getElementById('adminPassword').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('loginAdmin').click();
            }
        });

        // Lottery Results System
        const drawTimes = [
            { time: '09:30', id: 'result930', name: 'မနက်', color: 'text-blue-600' },
            { time: '14:00', id: 'result200', name: 'နေ့လည်', color: 'text-green-600' },
            { time: '16:30', id: 'result430', name: 'ညနေ', color: 'text-purple-600' }
        ];

        let todayResults = {
            '09:30': null,
            '14:00': null,
            '16:30': null
        };

        function updateCurrentDate() {
            const now = new Date();
            const options = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                weekday: 'long'
            };
            document.getElementById('currentDate').textContent = now.toLocaleDateString('my-MM', options);
        }

        function generateRandomResult() {
            return String(Math.floor(Math.random() * 100)).padStart(2, '0');
        }

        function updateLotteryResults() {
            drawTimes.forEach(draw => {
                const resultElement = document.getElementById(draw.id);
                
                if (todayResults[draw.time]) {
                    // Display admin-set result with animation
                    resultElement.textContent = todayResults[draw.time];
                    resultElement.className = `text-3xl font-bold ${draw.color} animate-pulse`;
                    
                    // Add celebration effect
                    setTimeout(() => {
                        resultElement.classList.remove('animate-pulse');
                        resultElement.classList.add('animate-bounce-slow');
                    }, 1000);
                } else {
                    // Show waiting for admin to set result
                    resultElement.textContent = 'မထွက်သေး';
                    resultElement.className = 'text-3xl font-bold text-gray-400';
                }
            });
        }

        function updateNextDrawTime() {
            const now = new Date();
            const currentTime = now.getHours() * 100 + now.getMinutes();
            
            let nextDraw = null;
            
            for (let draw of drawTimes) {
                const drawTime = parseInt(draw.time.replace(':', ''));
                if (currentTime < drawTime) {
                    nextDraw = draw;
                    break;
                }
            }
            
            const nextDrawElement = document.getElementById('nextDrawTime');
            
            if (nextDraw) {
                const drawHour = Math.floor(parseInt(nextDraw.time.replace(':', '')) / 100);
                const drawMinute = parseInt(nextDraw.time.replace(':', '')) % 100;
                const drawDate = new Date();
                drawDate.setHours(drawHour, drawMinute, 0, 0);
                
                const timeDiff = drawDate - now;
                const hours = Math.floor(timeDiff / (1000 * 60 * 60));
                const minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));
                
                if (timeDiff > 0) {
                    nextDrawElement.textContent = `${nextDraw.name} ${nextDraw.time} (${hours}နာရီ ${minutes}မိနစ် ကျန်)`;
                } else {
                    nextDrawElement.textContent = `${nextDraw.name} ${nextDraw.time} - ထွက်နေပြီ`;
                }
            } else {
                // All draws for today are done
                nextDrawElement.textContent = 'ယနေ့ ထီများ အားလုံး ထွက်ပြီးပါပြီ';
            }
        }

        // Check for winning numbers
        function checkWinningNumbers() {
            const completedDraws = Object.entries(todayResults).filter(([time, result]) => result !== null);
            
            if (completedDraws.length === 0) return;
            
            // Check user's history for winning bets
            history.forEach(historyItem => {
                if (historyItem.status === 'အောင်မြင်ပါသည်') {
                    historyItem.bets.forEach(bet => {
                        completedDraws.forEach(([time, result]) => {
                            if (bet.number === result) {
                                // Mark as winner (this is just for display, real system would handle payouts)
                                bet.isWinner = true;
                                bet.winningDraw = time;
                            }
                        });
                    });
                }
            });
            
            updateHistoryDisplay();
        }

        // Admin lottery control functions
        function setLotteryResult(time, inputId) {
            const input = document.getElementById(inputId);
            const number = input.value.trim();
            
            // Validation
            if (!number || number.length !== 2 || isNaN(parseInt(number))) {
                alert('နံပါတ် ၂ လုံး ရိုက်ထည့်ပါ (00-99)');
                return;
            }
            
            const formattedNumber = String(parseInt(number)).padStart(2, '0');
            
            // Set the result
            todayResults[time] = formattedNumber;
            
            // Update display
            updateLotteryResults();
            checkWinningNumbers();
            
            // Clear input
            input.value = '';
            
            // Show success message
            const timeDisplay = time === '09:30' ? 'မနက် 9:30' : 
                               time === '14:00' ? 'နေ့လည် 2:00' : 'ညနေ 4:30';
            alert(`${timeDisplay} ထီရလဒ် ${formattedNumber} သတ်မှတ်ပြီးပါပြီ!`);
        }
        
        function clearAllResults() {
            if (confirm('ထီရလဒ် အားလုံး ရှင်းလင်းမှာ သေချာပါသလား?')) {
                todayResults = {
                    '09:30': null,
                    '14:00': null,
                    '16:30': null
                };
                
                // Reset display
                document.getElementById('result930').textContent = 'မထွက်သေး';
                document.getElementById('result930').className = 'text-3xl font-bold text-gray-400';
                
                document.getElementById('result200').textContent = 'မထွက်သေး';
                document.getElementById('result200').className = 'text-3xl font-bold text-gray-400';
                
                document.getElementById('result430').textContent = 'မထွက်သေး';
                document.getElementById('result430').className = 'text-3xl font-bold text-gray-400';
                
                // Clear admin inputs
                document.getElementById('admin930').value = '';
                document.getElementById('admin200').value = '';
                document.getElementById('admin430').value = '';
                
                alert('ထီရလဒ် အားလုံး ရှင်းလင်းပြီးပါပြီ!');
            }
        }

        // Auto-generate results for demo (disabled - now admin controlled)
        function simulateDrawResults() {
            // Disabled - results are now controlled by admin only
            // Admin must manually set results using the admin panel
        }

        // Initialize lottery system
        function initializeLotterySystem() {
            updateCurrentDate();
            simulateDrawResults(); // For demo
            updateLotteryResults();
            updateNextDrawTime();
            checkWinningNumbers();
            
            // Update every minute
            setInterval(() => {
                updateLotteryResults();
                updateNextDrawTime();
                checkWinningNumbers();
            }, 60000);
        }

        // Initialize
        setupFileUpload();
        updateBetDisplay();
        updateTotal();
        updatePayButton();
        updateHistoryDisplay();
        updateAdminHistoryDisplay();
        initializeLotterySystem();
        
        // Show login screen on startup
        showLoginScreen();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97e96df833b9893a',t:'MTc1Nzc4NTIyNS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html><!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Myanmar 2D Lottery - မြန်မာ ၂လုံး ထီ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .lottery-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .wave-pay-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            transition: all 0.3s ease;
        }
        .wave-pay-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(238, 90, 36, 0.3);
        }
        .bet-card {
            transition: all 0.2s ease;
            border: 2px solid transparent;
        }
        .bet-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        .animate-bounce-slow {
            animation: bounce 2s infinite;
        }
        .upload-area {
            border: 2px dashed #d1d5db;
            transition: all 0.3s ease;
        }
        .upload-area:hover {
            border-color: #3b82f6;
            background-color: #f8fafc;
        }
        .upload-area.dragover {
            border-color: #10b981;
            background-color: #ecfdf5;
        }
    </style>
</head>
<body class="lottery-bg min-h-screen">
    <!-- Login Screen -->
    <div id="loginScreen" class="min-h-screen flex items-center justify-center px-4">
        <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full overflow-hidden">
            <!-- Login Header -->
            <div class="bg-gradient-to-r from-purple-600 to-blue-600 p-6 text-white text-center">
                <div class="text-4xl mb-2">🎰</div>
                <h1 class="text-2xl font-bold mb-1">Myanmar 2D Lottery</h1>
                <p class="opacity-90">မြန်မာ ၂လုံး ထီ</p>
            </div>
            
            <!-- Login Form -->
            <div class="p-6">
                <h2 class="text-xl font-bold text-gray-800 mb-6 text-center">🔐 အကောင့်ဝင်ရောက်ရန်</h2>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">📱 ဖုန်းနံပါတ်</label>
                        <input type="tel" id="loginPhone" placeholder="09xxxxxxxxx" 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 text-lg">
                        <p class="text-xs text-gray-500 mt-1">ဥပမာ: 09123456789</p>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">🔑 လျှို့ဝှက်နံပါတ်</label>
                        <div class="relative">
                            <input type="password" id="loginPassword" placeholder="လျှို့ဝှက်နံပါတ် ထည့်ပါ" 
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 text-lg pr-12">
                            <button type="button" id="togglePassword" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700">
                                👁️
                            </button>
                        </div>
                    </div>
                    
                    <button id="loginBtn" class="w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white font-bold py-3 px-6 rounded-lg transition-all transform hover:scale-105">
                        🚀 ဝင်ရောက်မည်
                    </button>
                </div>
                
                <div class="mt-6 text-center">
                    <p class="text-sm text-gray-600 mb-3">အကောင့်မရှိသေးဘူးလား?</p>
                    <button id="showRegisterBtn" class="text-purple-600 hover:text-purple-800 font-medium underline">
                        📝 အကောင့်အသစ်ဖွင့်ရန်
                    </button>
                </div>
                
                <!-- Demo Accounts -->
                <div class="mt-6 bg-yellow-50 rounded-lg p-4">
                    <h3 class="text-sm font-bold text-yellow-800 mb-2">🎯 စမ်းသုံးရန် အကောင့်များ</h3>
                    <div class="text-xs text-yellow-700 space-y-1">
                        <p><strong>User:</strong> 09123456789 / password: 123456</p>
                        <p><strong>VIP:</strong> 09987654321 / password: vip123</p>
                        <p><strong>Admin:</strong> 09750397287 / password: admin123</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Register Screen -->
    <div id="registerScreen" class="min-h-screen flex items-center justify-center px-4 hidden">
        <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full overflow-hidden">
            <!-- Register Header -->
            <div class="bg-gradient-to-r from-green-600 to-emerald-600 p-6 text-white text-center">
                <div class="text-4xl mb-2">📝</div>
                <h1 class="text-2xl font-bold mb-1">အကောင့်အသစ်ဖွင့်ရန်</h1>
                <p class="opacity-90">New Account Registration</p>
            </div>
            
            <!-- Register Form -->
            <div class="p-6">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">👤 အမည်</label>
                        <input type="text" id="registerName" placeholder="သင့်အမည် ထည့်ပါ" 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-lg">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">📱 ဖုန်းနံပါတ်</label>
                        <input type="tel" id="registerPhone" placeholder="09xxxxxxxxx" 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-lg">
                        <p class="text-xs text-gray-500 mt-1">ဥပမာ: 09123456789</p>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">🔑 လျှို့ဝှက်နံပါတ်</label>
                        <input type="password" id="registerPassword" placeholder="အနည်းဆုံး ၆ လုံး" 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-lg">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">🔑 လျှို့ဝှက်နံပါတ် အတည်ပြုရန်</label>
                        <input type="password" id="confirmPassword" placeholder="လျှို့ဝှက်နံပါတ် ပြန်ထည့်ပါ" 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-lg">
                    </div>
                    
                    <button id="registerBtn" class="w-full bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white font-bold py-3 px-6 rounded-lg transition-all transform hover:scale-105">
                        ✅ အကောင့်ဖွင့်မည်
                    </button>
                </div>
                
                <div class="mt-6 text-center">
                    <button id="showLoginBtn" class="text-green-600 hover:text-green-800 font-medium underline">
                        ⬅️ အကောင့်ဝင်ရောက်ရန် ပြန်သွားမည်
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App (Hidden by default) -->
    <div id="mainApp" class="container mx-auto px-4 py-8 hidden">
        <!-- Header with User Profile -->
        <div class="bg-white rounded-2xl shadow-2xl mb-8 overflow-hidden">
            <div class="bg-gradient-to-r from-purple-600 to-blue-600 p-4">
                <div class="flex justify-between items-center">
                    <div class="flex items-center gap-3">
                        <div class="bg-white bg-opacity-20 rounded-full p-2">
                            <span class="text-2xl">👤</span>
                        </div>
                        <div class="text-white">
                            <div class="font-bold text-lg" id="userDisplayName">Loading...</div>
                            <div class="text-sm opacity-90" id="userDisplayPhone">Loading...</div>
                        </div>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="text-white text-right">
                            <div class="text-xs opacity-75">လက်ကျန်ငွေ</div>
                            <div class="font-bold text-lg" id="userBalance">0 ကျပ်</div>
                        </div>
                        <button id="logoutBtn" class="bg-white bg-opacity-20 hover:bg-opacity-30 text-white p-2 rounded-lg transition-colors">
                            🚪
                        </button>
                    </div>
                </div>
            </div>
            <div class="text-center py-4">
                <h1 class="text-2xl font-bold text-gray-800 mb-1">🎰 Myanmar 2D Lottery</h1>
                <p class="text-gray-600">မြန်မာ ၂လုံး ထီ - ကံကောင်းပါစေ! 🍀</p>
            </div>
        </div>

        <!-- Lottery Results Display -->
        <div class="max-w-4xl mx-auto mb-8">
            <div class="bg-white rounded-2xl shadow-2xl overflow-hidden">
                <div class="bg-gradient-to-r from-yellow-500 to-orange-500 p-4 text-white text-center">
                    <h2 class="text-2xl font-bold mb-1">🏆 ယနေ့ ထီရလဒ်များ</h2>
                    <p class="opacity-90" id="currentDate">Loading...</p>
                </div>
                
                <div class="p-6">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <!-- 9:30 AM Draw -->
                        <div class="text-center">
                            <div class="bg-blue-50 rounded-lg p-4">
                                <div class="text-lg font-bold text-blue-800 mb-2">🌅 မနက် 9:30</div>
                                <div class="bg-white rounded-lg p-4 shadow-inner">
                                    <div id="result930" class="text-3xl font-bold text-gray-400">မထွက်သေး</div>
                                </div>
                                <div class="text-xs text-gray-500 mt-2">Morning Draw</div>
                            </div>
                        </div>
                        
                        <!-- 2:00 PM Draw -->
                        <div class="text-center">
                            <div class="bg-green-50 rounded-lg p-4">
                                <div class="text-lg font-bold text-green-800 mb-2">☀️ နေ့လည် 2:00</div>
                                <div class="bg-white rounded-lg p-4 shadow-inner">
                                    <div id="result200" class="text-3xl font-bold text-gray-400">မထွက်သေး</div>
                                </div>
                                <div class="text-xs text-gray-500 mt-2">Afternoon Draw</div>
                            </div>
                        </div>
                        
                        <!-- 4:30 PM Draw -->
                        <div class="text-center">
                            <div class="bg-purple-50 rounded-lg p-4">
                                <div class="text-lg font-bold text-purple-800 mb-2">🌆 ညနေ 4:30</div>
                                <div class="bg-white rounded-lg p-4 shadow-inner">
                                    <div id="result430" class="text-3xl font-bold text-gray-400">မထွက်သေး</div>
                                </div>
                                <div class="text-xs text-gray-500 mt-2">Evening Draw</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Next Draw Countdown -->
                    <div class="mt-6 text-center">
                        <div class="bg-gray-100 rounded-lg p-4">
                            <div class="text-sm text-gray-600 mb-1">နောက်ထီ ထွက်ချိန်</div>
                            <div id="nextDrawTime" class="text-lg font-bold text-orange-600">Loading...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Game Area -->
        <div class="max-w-2xl mx-auto bg-white rounded-2xl shadow-2xl overflow-hidden">
            <!-- Game Header -->
            <div class="bg-gradient-to-r from-purple-600 to-blue-600 p-6 text-white text-center">
                <h2 class="text-2xl font-bold mb-2">🎯 ထီထိုးရန်</h2>
                <p class="opacity-90">နံပါတ်နှင့် ငွေပမာဏ ထည့်သွင်းပါ</p>
            </div>

            <!-- Number Entry Form -->
            <div class="p-6">
                <div class="bg-gray-50 rounded-lg p-4 mb-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">🎫 ထီထိုးရန် ထည့်သွင်းပါ</h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">နံပါတ်</label>
                            <input type="text" id="numberInput" placeholder="ဥပမာ: 23" maxlength="2" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 text-center text-xl font-bold">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">ငွေပမာဏ (ကျပ်)</label>
                            <input type="number" id="amountInput" placeholder="100" min="100" step="100"
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 text-center text-lg font-bold">
                        </div>
                        <div class="flex items-end">
                            <button id="addBetBtn" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition-colors">
                                ➕ ထည့်မည်
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Bet List -->
                <div class="mb-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">📋 ထိုးထားသော ထီများ</h3>
                    <div id="betList" class="space-y-3 min-h-[100px]">
                        <div class="text-center text-gray-500 py-8">
                            <p>ထီမထိုးရသေးပါ</p>
                            <p class="text-sm">နံပါတ်နှင့် ငွေပမာဏ ထည့်ပြီး ထည့်မည် ကိုနှိပ်ပါ</p>
                        </div>
                    </div>
                </div>

                <!-- Total Amount -->
                <div class="bg-yellow-100 rounded-lg p-4 mb-6">
                    <div class="flex justify-between items-center">
                        <span class="text-lg font-bold text-gray-800">💵 စုစုပေါင်း</span>
                        <span id="totalAmount" class="text-2xl font-bold text-green-600">0 ကျပ်</span>
                    </div>
                </div>

                <!-- Payment Button -->
                <button id="payNowBtn" class="w-full wave-pay-btn text-white font-bold py-4 px-6 rounded-xl text-lg disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                    🚀 Wave Pay ဖြင့် ပေးချေမည်
                </button>
            </div>
        </div>

        <!-- Wave Pay Transfer Modal -->
        <div id="wavePayModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white rounded-2xl max-w-md mx-4 overflow-hidden">
                <!-- Wave Pay Header -->
                <div class="bg-gradient-to-r from-red-500 to-pink-500 p-4 text-white">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-2">
                            <span class="text-2xl">📱</span>
                            <span class="font-bold text-lg">Wave Pay လွှဲပြောင်းမှု</span>
                        </div>
                        <button id="closeWaveModal" class="text-white text-xl">✕</button>
                    </div>
                </div>
                
                <!-- Transfer Instructions -->
                <div class="p-6">
                    <div class="text-center mb-6">
                        <div class="text-4xl mb-3">💰</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">ငွေလွှဲပြောင်းရန်</h3>
                        <div class="bg-gray-100 rounded-lg p-4 mb-4">
                            <div class="text-sm text-gray-600 mb-1">လွှဲရမည့်ငွေ</div>
                            <div id="transferAmount" class="text-2xl font-bold text-red-500">0 ကျပ်</div>
                        </div>
                    </div>
                    
                    <!-- Transfer Details -->
                    <div class="bg-blue-50 rounded-lg p-4 mb-6">
                        <h4 class="font-bold text-gray-800 mb-2">📞 လွှဲရမည့် အကောင့်</h4>
                        <div class="space-y-1 text-sm">
                            <p><span class="font-medium">ဖုန်းနံပါတ်:</span> 09750397287</p>
                            <p><span class="font-medium">အမည်:</span> Khant Lwin Moe</p>
                        </div>
                    </div>

                    <!-- Sender Phone Number -->
                    <div class="mb-4">
                        <h4 class="font-bold text-gray-800 mb-2">📱 လွှဲသူ ဖုန်းနံပါတ်</h4>
                        <input type="text" id="senderPhone" placeholder="ဥပမာ: 09123456789" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500">
                        <p class="text-xs text-gray-500 mt-1">Wave Pay မှ လွှဲသော ဖုန်းနံပါတ် ထည့်ပါ</p>
                    </div>

                    <!-- Upload Receipt -->
                    <div class="mb-6">
                        <h4 class="font-bold text-gray-800 mb-3">📸 ငွေလွှဲပြေစာ တင်ပါ</h4>
                        <div id="uploadArea" class="upload-area rounded-lg p-6 text-center cursor-pointer">
                            <div id="uploadContent">
                                <div class="text-4xl mb-2">📤</div>
                                <p class="text-gray-600 mb-1">ပြေစာပုံ တင်ရန် နှိပ်ပါ</p>
                                <p class="text-xs text-gray-500">PNG, JPG ဖိုင်များ လက်ခံပါသည်</p>
                            </div>
                            <div id="uploadedImage" class="hidden">
                                <img id="receiptImage" class="max-w-full h-32 object-cover rounded mx-auto mb-2">
                                <p class="text-green-600 font-medium">✅ ပြေစာ တင်ပြီးပါပြီ</p>
                            </div>
                        </div>
                        <input type="file" id="fileInput" accept="image/*" class="hidden">
                    </div>
                    
                    <div class="space-y-3">
                        <button id="submitPayment" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                            ✅ လုပ်ဆောင်မည်
                        </button>
                        <button id="cancelPayment" class="w-full bg-gray-300 hover:bg-gray-400 text-gray-700 font-bold py-3 px-6 rounded-lg transition-colors">
                            ❌ ပယ်ဖျက်မည်
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- History Modal -->
        <div id="historyModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white rounded-2xl max-w-md mx-4 overflow-hidden">
                <div class="bg-gradient-to-r from-blue-500 to-purple-500 p-4 text-white text-center">
                    <h3 class="text-xl font-bold">📊 ထီထိုးမှု မှတ်တမ်း</h3>
                </div>
                
                <div class="p-6">
                    <div id="historyContent" class="space-y-4">
                        <!-- History items will be added here -->
                    </div>
                    
                    <button id="closeHistory" class="w-full bg-gray-300 hover:bg-gray-400 text-gray-700 font-bold py-3 px-6 rounded-lg transition-colors mt-4">
                        ပိတ်မည်
                    </button>
                </div>
            </div>
        </div>

        <!-- Admin Panel Modal -->
        <div id="adminModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white rounded-2xl max-w-md mx-4 overflow-hidden">
                <div class="bg-gradient-to-r from-green-500 to-emerald-500 p-4 text-white text-center">
                    <h3 class="text-xl font-bold">🔐 Admin Panel</h3>
                </div>
                
                <div class="p-6">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Admin Password</label>
                        <input type="password" id="adminPassword" placeholder="Enter admin password" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                    </div>
                    
                    <div class="space-y-3">
                        <button id="loginAdmin" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg transition-colors">
                            🔓 Login
                        </button>
                        <button id="closeAdmin" class="w-full bg-gray-300 hover:bg-gray-400 text-gray-700 font-bold py-3 px-6 rounded-lg transition-colors">
                            ❌ Cancel
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Admin History Modal -->
        <div id="adminHistoryModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white rounded-2xl max-w-2xl mx-4 overflow-hidden">
                <div class="bg-gradient-to-r from-green-500 to-emerald-500 p-4 text-white">
                    <div class="flex items-center justify-between">
                        <h3 class="text-xl font-bold">👑 Admin Panel</h3>
                        <button id="closeAdminHistory" class="text-white text-xl">✕</button>
                    </div>
                </div>
                
                <div class="p-6 max-h-96 overflow-y-auto">
                    <!-- Lottery Results Control -->
                    <div class="mb-6 bg-yellow-50 rounded-lg p-4">
                        <h4 class="text-lg font-bold text-gray-800 mb-4">🎰 ထီရလဒ် ထိန်းချုပ်မှု</h4>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                            <!-- 9:30 AM Control -->
                            <div class="text-center">
                                <div class="text-sm font-medium text-blue-800 mb-2">မနက် 9:30</div>
                                <input type="text" id="admin930" placeholder="00-99" maxlength="2" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-center text-lg font-bold">
                                <button onclick="setLotteryResult('09:30', 'admin930')" 
                                        class="w-full mt-2 bg-blue-500 hover:bg-blue-600 text-white font-bold py-1 px-2 rounded text-sm transition-colors">
                                    Set Result
                                </button>
                            </div>
                            
                            <!-- 2:00 PM Control -->
                            <div class="text-center">
                                <div class="text-sm font-medium text-green-800 mb-2">နေ့လည် 2:00</div>
                                <input type="text" id="admin200" placeholder="00-99" maxlength="2" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 text-center text-lg font-bold">
                                <button onclick="setLotteryResult('14:00', 'admin200')" 
                                        class="w-full mt-2 bg-green-500 hover:bg-green-600 text-white font-bold py-1 px-2 rounded text-sm transition-colors">
                                    Set Result
                                </button>
                            </div>
                            
                            <!-- 4:30 PM Control -->
                            <div class="text-center">
                                <div class="text-sm font-medium text-purple-800 mb-2">ညနေ 4:30</div>
                                <input type="text" id="admin430" placeholder="00-99" maxlength="2" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 text-center text-lg font-bold">
                                <button onclick="setLotteryResult('16:30', 'admin430')" 
                                        class="w-full mt-2 bg-purple-500 hover:bg-purple-600 text-white font-bold py-1 px-2 rounded text-sm transition-colors">
                                    Set Result
                                </button>
                            </div>
                        </div>
                        
                        <div class="text-center">
                            <button onclick="clearAllResults()" 
                                    class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded transition-colors">
                                🗑️ Clear All Results
                            </button>
                        </div>
                    </div>
                    
                    <!-- Pending Approvals -->
                    <div class="bg-blue-50 rounded-lg p-4">
                        <h4 class="text-lg font-bold text-gray-800 mb-4">📋 Pending Approvals</h4>
                        <div id="adminHistoryContent" class="space-y-4">
                            <!-- Admin history items will be added here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Floating Buttons -->
        <div class="fixed bottom-6 right-6 space-y-3">
            <button id="historyBtn" class="bg-blue-500 hover:bg-blue-600 text-white p-4 rounded-full shadow-lg transition-colors block">
                📊
            </button>
            <button id="adminBtn" class="bg-green-500 hover:bg-green-600 text-white p-4 rounded-full shadow-lg transition-colors block">
                👑
            </button>
        </div>
    </div>

    <script>
        // User Authentication System
        let currentUser = null;
        let users = [
            { phone: '09123456789', password: '123456', name: 'Mg Mg', balance: 50000, type: 'user' },
            { phone: '09987654321', password: 'vip123', name: 'Daw Aye', balance: 100000, type: 'vip' },
            { phone: '09750397287', password: 'admin123', name: 'Admin', balance: 999999, type: 'admin' }
        ];

        // Game state
        let betList = [];
        let totalAmount = 0;
        let history = [];

        // Authentication Functions
        function validatePhone(phone) {
            const phoneRegex = /^09\d{7,9}$/;
            return phoneRegex.test(phone);
        }

        function validatePassword(password) {
            return password.length >= 6;
        }

        function findUser(phone, password) {
            return users.find(user => user.phone === phone && user.password === password);
        }

        function registerUser(name, phone, password) {
            // Check if user already exists
            if (users.find(user => user.phone === phone)) {
                return { success: false, message: 'ဤဖုန်းနံပါတ်ဖြင့် အကောင့်ရှိပြီးပါပြီ' };
            }

            // Create new user
            const newUser = {
                phone: phone,
                password: password,
                name: name,
                balance: 0, // Starting balance - no money for new users
                type: 'user'
            };

            users.push(newUser);
            return { success: true, message: 'အကောင့်ဖွင့်ခြင်း အောင်မြင်ပါသည်!' };
        }

        function login(phone, password) {
            const user = findUser(phone, password);
            if (user) {
                currentUser = user;
                showMainApp();
                updateUserDisplay();
                return { success: true, message: 'အကောင့်ဝင်ရောက်ခြင်း အောင်မြင်ပါသည်!' };
            } else {
                return { success: false, message: 'ဖုန်းနံပါတ် သို့မဟုတ် လျှို့ဝှက်နံပါတ် မမှန်ကန်ပါ' };
            }
        }

        function logout() {
            currentUser = null;
            showLoginScreen();
            // Reset game state
            betList = [];
            totalAmount = 0;
            updateBetDisplay();
            updateTotal();
            updatePayButton();
        }

        function showLoginScreen() {
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('registerScreen').classList.add('hidden');
            document.getElementById('mainApp').classList.add('hidden');
        }

        function showRegisterScreen() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('registerScreen').classList.remove('hidden');
            document.getElementById('mainApp').classList.add('hidden');
        }

        function showMainApp() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('registerScreen').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
        }

        function updateUserDisplay() {
            if (currentUser) {
                document.getElementById('userDisplayName').textContent = currentUser.name;
                document.getElementById('userDisplayPhone').textContent = currentUser.phone;
                document.getElementById('userBalance').textContent = currentUser.balance.toLocaleString() + ' ကျပ်';
                
                // Show/hide admin button based on user type
                const adminBtn = document.getElementById('adminBtn');
                if (currentUser.type === 'admin') {
                    adminBtn.style.display = 'block';
                } else {
                    adminBtn.style.display = 'none';
                }
            }
        }

        // Login/Register Event Listeners
        document.getElementById('loginBtn').addEventListener('click', function() {
            const phone = document.getElementById('loginPhone').value.trim();
            const password = document.getElementById('loginPassword').value.trim();

            if (!phone || !password) {
                alert('ဖုန်းနံပါတ်နှင့် လျှို့ဝှက်နံပါတ် ထည့်ပါ');
                return;
            }

            if (!validatePhone(phone)) {
                alert('ဖုန်းနံပါတ် မှန်ကန်စွာ ထည့်ပါ (ဥပမာ: 09123456789)');
                return;
            }

            const result = login(phone, password);
            alert(result.message);

            if (result.success) {
                // Clear login form
                document.getElementById('loginPhone').value = '';
                document.getElementById('loginPassword').value = '';
            }
        });

        document.getElementById('registerBtn').addEventListener('click', function() {
            const name = document.getElementById('registerName').value.trim();
            const phone = document.getElementById('registerPhone').value.trim();
            const password = document.getElementById('registerPassword').value.trim();
            const confirmPassword = document.getElementById('confirmPassword').value.trim();

            if (!name || !phone || !password || !confirmPassword) {
                alert('အချက်အလက်များ အားလုံး ထည့်ပါ');
                return;
            }

            if (!validatePhone(phone)) {
                alert('ဖုန်းနံပါတ် မှန်ကန်စွာ ထည့်ပါ (ဥပမာ: 09123456789)');
                return;
            }

            if (!validatePassword(password)) {
                alert('လျှို့ဝှက်နံပါတ် အနည်းဆုံး ၆ လုံး ရှိရမည်');
                return;
            }

            if (password !== confirmPassword) {
                alert('လျှို့ဝှက်နံပါတ်များ မတူညီပါ');
                return;
            }

            const result = registerUser(name, phone, password);
            
            if (result.success) {
                alert(`${result.message}\n\n⚠️ အကောင့်အသစ်များ လက်ကျန်ငွေ 0 ကျပ်ဖြင့် စတင်ပါသည်။\nထီထိုးရန် ငွေဖြည့်သွင်းပါ။\n\nအကောင့်ဝင်ရောက်ရန် Login စာမျက်နှာသို့ သွားပါ။`);
                
                // Clear register form
                document.getElementById('registerName').value = '';
                document.getElementById('registerPhone').value = '';
                document.getElementById('registerPassword').value = '';
                document.getElementById('confirmPassword').value = '';
                
                // Go back to login screen instead of auto-login
                showLoginScreen();
            } else {
                alert(result.message);
            }
        });

        document.getElementById('showRegisterBtn').addEventListener('click', showRegisterScreen);
        document.getElementById('showLoginBtn').addEventListener('click', showLoginScreen);
        document.getElementById('logoutBtn').addEventListener('click', function() {
            if (confirm('အကောင့်မှ ထွက်မှာ သေချာပါသလား?')) {
                logout();
            }
        });

        // Password toggle
        document.getElementById('togglePassword').addEventListener('click', function() {
            const passwordInput = document.getElementById('loginPassword');
            const toggleBtn = document.getElementById('togglePassword');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleBtn.textContent = '🙈';
            } else {
                passwordInput.type = 'password';
                toggleBtn.textContent = '👁️';
            }
        });

        // Enter key support for login
        document.getElementById('loginPhone').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('loginPassword').focus();
            }
        });

        document.getElementById('loginPassword').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('loginBtn').click();
            }
        });

        // Enter key support for register
        document.getElementById('registerName').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('registerPhone').focus();
            }
        });

        document.getElementById('registerPhone').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('registerPassword').focus();
            }
        });

        document.getElementById('registerPassword').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('confirmPassword').focus();
            }
        });

        document.getElementById('confirmPassword').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('registerBtn').click();
            }
        });

        // Add bet function
        function addBet() {
            const numberInput = document.getElementById('numberInput');
            const amountInput = document.getElementById('amountInput');
            
            const number = numberInput.value.trim();
            const amount = parseInt(amountInput.value);
            
            // Validation
            if (!number || number.length !== 2 || isNaN(parseInt(number))) {
                alert('နံပါတ် ၂ လုံး ရိုက်ထည့်ပါ (ဥပမာ: 23)');
                return;
            }
            
            if (!amount || amount < 100) {
                alert('ငွေပမာဏ အနည်းဆုံး ၁၀၀ ကျပ် ထည့်ပါ');
                return;
            }
            
            // Check if number already exists
            const existingBet = betList.find(bet => bet.number === number);
            if (existingBet) {
                existingBet.amount += amount;
            } else {
                betList.push({ number, amount, id: Date.now() });
            }
            
            // Clear inputs
            numberInput.value = '';
            amountInput.value = '';
            
            updateBetDisplay();
            updateTotal();
            updatePayButton();
        }

        // Remove bet function
        function removeBet(id) {
            betList = betList.filter(bet => bet.id !== id);
            updateBetDisplay();
            updateTotal();
            updatePayButton();
        }

        // Update bet display
        function updateBetDisplay() {
            const container = document.getElementById('betList');
            
            if (betList.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <p>ထီမထိုးရသေးပါ</p>
                        <p class="text-sm">နံပါတ်နှင့် ငွေပမာဏ ထည့်ပြီး ထည့်မည် ကိုနှိပ်ပါ</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = betList.map(bet => `
                <div class="bet-card bg-white border rounded-lg p-4 flex justify-between items-center">
                    <div class="flex items-center gap-4">
                        <div class="bg-blue-500 text-white w-12 h-12 rounded-full flex items-center justify-center font-bold text-lg">
                            ${bet.number}
                        </div>
                        <div>
                            <div class="font-bold text-gray-800">${bet.amount.toLocaleString()} ကျပ်</div>
                            <div class="text-sm text-gray-600">နံပါတ် ${bet.number}</div>
                        </div>
                    </div>
                    <button onclick="removeBet(${bet.id})" class="text-red-500 hover:text-red-700 text-xl">
                        🗑️
                    </button>
                </div>
            `).join('');
        }

        // Update total
        function updateTotal() {
            totalAmount = betList.reduce((sum, bet) => sum + bet.amount, 0);
            document.getElementById('totalAmount').textContent = totalAmount.toLocaleString() + ' ကျပ်';
        }

        // Update pay button
        function updatePayButton() {
            const payBtn = document.getElementById('payNowBtn');
            payBtn.disabled = betList.length === 0;
        }

        // File upload handling
        function setupFileUpload() {
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');
            const uploadContent = document.getElementById('uploadContent');
            const uploadedImage = document.getElementById('uploadedImage');
            const receiptImage = document.getElementById('receiptImage');
            const submitBtn = document.getElementById('submitPayment');

            uploadArea.addEventListener('click', () => fileInput.click());
            
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFile(files[0]);
                }
            });

            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleFile(e.target.files[0]);
                }
            });

            function handleFile(file) {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        receiptImage.src = e.target.result;
                        uploadContent.classList.add('hidden');
                        uploadedImage.classList.remove('hidden');
                        
                        // Validate receipt (simple check based on file name or content)
                        const isValidReceipt = validateReceipt(file, e.target.result);
                        
                        if (isValidReceipt) {
                            document.getElementById('uploadedImage').innerHTML = `
                                <img id="receiptImage" src="${e.target.result}" class="max-w-full h-32 object-cover rounded mx-auto mb-2">
                                <p class="text-green-600 font-medium">✅ ပြေစာ မှန်ကန်ပါသည်</p>
                            `;
                            submitBtn.disabled = false;
                            submitBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                        } else {
                            document.getElementById('uploadedImage').innerHTML = `
                                <img id="receiptImage" src="${e.target.result}" class="max-w-full h-32 object-cover rounded mx-auto mb-2">
                                <p class="text-red-600 font-medium">❌ ပြေစာမမှန်ကန်ပါ</p>
                                <p class="text-xs text-red-500">တကယ့် Wave Pay ပြေစာ တင်ပါ</p>
                            `;
                            submitBtn.disabled = true;
                            submitBtn.classList.add('opacity-50', 'cursor-not-allowed');
                        }
                    };
                    reader.readAsDataURL(file);
                } else {
                    alert('ပုံဖိုင်များသာ လက်ခံပါသည်');
                }
            }
            
            function validateReceipt(file, dataUrl) {
                // Simple validation based on file name and basic image analysis
                const fileName = file.name.toLowerCase();
                
                // Check if filename contains wave pay related keywords
                const waveKeywords = ['wave', 'pay', 'receipt', 'transfer', 'ငွေလွှဲ', 'ပြေစာ'];
                const hasWaveKeyword = waveKeywords.some(keyword => fileName.includes(keyword));
                
                // Check file size (receipts are usually not too small)
                const isReasonableSize = file.size > 10000; // At least 10KB
                
                // For demo purposes, we'll also check if it's a screenshot (usually larger files)
                const isLikelyScreenshot = file.size > 50000; // At least 50KB
                
                // Simple validation: must have wave keyword OR be a reasonable size screenshot
                return hasWaveKeyword || (isReasonableSize && isLikelyScreenshot);
            }
        }

        // Add to history
        function addToHistory(bets, amount, status = 'လုပ်ဆောင်နေဆဲ', senderPhone = null) {
            const historyItem = {
                id: Date.now(),
                date: new Date().toLocaleString('my-MM'),
                bets: [...bets],
                amount: amount,
                status: status,
                senderPhone: senderPhone,
                user: currentUser ? {
                    name: currentUser.name,
                    phone: currentUser.phone,
                    type: currentUser.type
                } : null
            };
            history.unshift(historyItem);
            updateHistoryDisplay();
            updateAdminHistoryDisplay();
        }

        // Approve transaction
        function approveTransaction(id) {
            const item = history.find(h => h.id === id);
            if (item) {
                item.status = 'အောင်မြင်ပါသည်';
                
                // If user exists, no need to refund (already deducted)
                updateHistoryDisplay();
                updateAdminHistoryDisplay();
                
                alert(`Transaction approved for ${item.user ? item.user.name : 'Unknown User'}\nAmount: ${item.amount.toLocaleString()} ကျပ်`);
            }
        }

        // Reject transaction
        function rejectTransaction(id) {
            const item = history.find(h => h.id === id);
            if (item) {
                item.status = 'ပယ်ဖျက်ပြီး';
                
                // Refund balance to user if user exists
                if (item.user) {
                    const user = users.find(u => u.phone === item.user.phone);
                    if (user) {
                        user.balance += item.amount;
                        // Update display if it's the current user
                        if (currentUser && currentUser.phone === user.phone) {
                            currentUser.balance = user.balance;
                            updateUserDisplay();
                        }
                    }
                }
                
                updateHistoryDisplay();
                updateAdminHistoryDisplay();
                
                alert(`Transaction rejected and refunded for ${item.user ? item.user.name : 'Unknown User'}\nRefund: ${item.amount.toLocaleString()} ကျပ်`);
            }
        }

        // Update history display
        function updateHistoryDisplay() {
            const container = document.getElementById('historyContent');
            
            if (history.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-500">မှတ်တမ်းမရှိပါ</p>';
                return;
            }
            
            container.innerHTML = history.map(item => `
                <div class="border rounded-lg p-4">
                    <div class="flex justify-between items-start mb-2">
                        <div class="text-sm text-gray-600">${item.date}</div>
                        <div class="text-sm font-medium ${
                            item.status === 'လုပ်ဆောင်နေဆဲ' ? 'text-orange-600' : 
                            item.status === 'အောင်မြင်ပါသည်' ? 'text-green-600' : 'text-red-600'
                        }">
                            ${item.status}
                        </div>
                    </div>
                    <div class="mb-2">
                        <div class="text-sm text-gray-600 mb-1">ထိုးထားသော နံပါတ်များ:</div>
                        <div class="flex flex-wrap gap-1">
                            ${item.bets.map(bet => `<span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs">${bet.number} (${bet.amount}ကျပ်)</span>`).join('')}
                        </div>
                    </div>
                    <div class="text-right font-bold text-green-600">${item.amount.toLocaleString()} ကျပ်</div>
                </div>
            `).join('');
        }

        // Update admin history display
        function updateAdminHistoryDisplay() {
            const container = document.getElementById('adminHistoryContent');
            const pendingItems = history.filter(item => item.status === 'လုပ်ဆောင်နေဆဲ');
            
            if (pendingItems.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-500">Approve လုပ်ရန် မရှိပါ</p>';
                return;
            }
            
            container.innerHTML = pendingItems.map(item => `
                <div class="border rounded-lg p-4 bg-yellow-50">
                    <div class="flex justify-between items-start mb-2">
                        <div class="text-sm text-gray-600">${item.date}</div>
                        <div class="text-sm font-medium text-orange-600">
                            ${item.status}
                        </div>
                    </div>
                    ${item.user ? `
                    <div class="mb-2 bg-blue-50 rounded p-2">
                        <div class="text-sm text-gray-600">👤 အကောင့်ပိုင်ရှင်:</div>
                        <div class="text-sm font-medium text-blue-800">${item.user.name} (${item.user.phone})</div>
                        <div class="text-xs text-blue-600">${item.user.type === 'admin' ? 'Admin' : item.user.type === 'vip' ? 'VIP User' : 'Regular User'}</div>
                    </div>
                    ` : ''}
                    ${item.senderPhone ? `
                    <div class="mb-2">
                        <div class="text-sm text-gray-600">📱 လွှဲသူ ဖုန်းနံပါတ်:</div>
                        <div class="text-sm font-medium text-blue-600">${item.senderPhone}</div>
                    </div>
                    ` : ''}
                    <div class="mb-3">
                        <div class="text-sm text-gray-600 mb-1">ထိုးထားသော နံပါတ်များ:</div>
                        <div class="flex flex-wrap gap-1 mb-2">
                            ${item.bets.map(bet => `<span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs">${bet.number} (${bet.amount}ကျပ်)</span>`).join('')}
                        </div>
                        <div class="text-right font-bold text-green-600">${item.amount.toLocaleString()} ကျပ်</div>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="approveTransaction(${item.id})" class="flex-1 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded transition-colors">
                            ✅ Approve
                        </button>
                        <button onclick="rejectTransaction(${item.id})" class="flex-1 bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded transition-colors">
                            ❌ Reject
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Event listeners
        document.getElementById('addBetBtn').addEventListener('click', addBet);
        
        document.getElementById('numberInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('amountInput').focus();
            }
        });
        
        document.getElementById('amountInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addBet();
            }
        });

        document.getElementById('payNowBtn').addEventListener('click', function() {
            if (betList.length === 0) {
                alert('ထီထိုးပါ');
                return;
            }
            
            document.getElementById('transferAmount').textContent = totalAmount.toLocaleString() + ' ကျပ်';
            document.getElementById('wavePayModal').classList.remove('hidden');
            document.getElementById('wavePayModal').classList.add('flex');
        });

        document.getElementById('closeWaveModal').addEventListener('click', function() {
            document.getElementById('wavePayModal').classList.add('hidden');
            document.getElementById('wavePayModal').classList.remove('flex');
            // Reset upload
            document.getElementById('uploadContent').classList.remove('hidden');
            document.getElementById('uploadedImage').classList.add('hidden');
            document.getElementById('submitPayment').disabled = true;
            document.getElementById('submitPayment').classList.add('opacity-50', 'cursor-not-allowed');
            // Reset phone field
            document.getElementById('senderPhone').value = '';
        });

        document.getElementById('cancelPayment').addEventListener('click', function() {
            document.getElementById('wavePayModal').classList.add('hidden');
            document.getElementById('wavePayModal').classList.remove('flex');
            // Reset phone field
            document.getElementById('senderPhone').value = '';
        });

        document.getElementById('submitPayment').addEventListener('click', function() {
            // Check if user has sufficient balance
            if (!currentUser) {
                alert('အကောင့်ဝင်ရောက်ပါ');
                return;
            }

            if (currentUser.balance < totalAmount) {
                alert(`လက်ကျန်ငွေ မလုံလောက်ပါ!\nလိုအပ်သော ငွေ: ${totalAmount.toLocaleString()} ကျပ်\nလက်ကျန်ငွေ: ${currentUser.balance.toLocaleString()} ကျပ်`);
                return;
            }

            // Get sender phone number
            const senderPhone = document.getElementById('senderPhone').value.trim();
            
            if (!senderPhone) {
                alert('လွှဲသူ ဖုန်းနံပါတ် ထည့်ပါ');
                return;
            }
            
            // Show processing message
            const submitBtn = document.getElementById('submitPayment');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '⏳ လုပ်ဆောင်နေသည်...';
            submitBtn.disabled = true;
            
            // Simulate processing time
            setTimeout(() => {
                // Deduct balance
                currentUser.balance -= totalAmount;
                updateUserDisplay();
                
                // Add to history with sender phone and user info
                addToHistory(betList, totalAmount, 'လုပ်ဆောင်နေဆဲ', senderPhone);
                
                // Reset game
                betList = [];
                updateBetDisplay();
                updateTotal();
                updatePayButton();
                
                // Reset form
                document.getElementById('senderPhone').value = '';
                
                // Close modal
                document.getElementById('wavePayModal').classList.add('hidden');
                document.getElementById('wavePayModal').classList.remove('flex');
                
                // Reset submit button
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
                
                // Show success message with admin review notice
                alert(`ထီထိုးမှု အောင်မြင်ပါသည်!\n\nငွေပမာဏ: ${totalAmount.toLocaleString()} ကျပ်\nလက်ကျန်ငွေ: ${currentUser.balance.toLocaleString()} ကျပ်\n\nAdmin မှ အတည်ပြုပေးရန် စောင့်ဆိုင်းပါ။`);
            }, 2000);
        });

        document.getElementById('historyBtn').addEventListener('click', function() {
            document.getElementById('historyModal').classList.remove('hidden');
            document.getElementById('historyModal').classList.add('flex');
        });

        document.getElementById('closeHistory').addEventListener('click', function() {
            document.getElementById('historyModal').classList.add('hidden');
            document.getElementById('historyModal').classList.remove('flex');
        });

        // Admin event listeners
        document.getElementById('adminBtn').addEventListener('click', function() {
            document.getElementById('adminModal').classList.remove('hidden');
            document.getElementById('adminModal').classList.add('flex');
        });

        document.getElementById('closeAdmin').addEventListener('click', function() {
            document.getElementById('adminModal').classList.add('hidden');
            document.getElementById('adminModal').classList.remove('flex');
            document.getElementById('adminPassword').value = '';
        });

        document.getElementById('loginAdmin').addEventListener('click', function() {
            const password = document.getElementById('adminPassword').value;
            if (password === 'admin123') {
                document.getElementById('adminModal').classList.add('hidden');
                document.getElementById('adminModal').classList.remove('flex');
                document.getElementById('adminHistoryModal').classList.remove('hidden');
                document.getElementById('adminHistoryModal').classList.add('flex');
                document.getElementById('adminPassword').value = '';
            } else {
                alert('Wrong password!');
            }
        });

        document.getElementById('closeAdminHistory').addEventListener('click', function() {
            document.getElementById('adminHistoryModal').classList.add('hidden');
            document.getElementById('adminHistoryModal').classList.remove('flex');
        });

        document.getElementById('adminPassword').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('loginAdmin').click();
            }
        });

        // Lottery Results System
        const drawTimes = [
            { time: '09:30', id: 'result930', name: 'မနက်', color: 'text-blue-600' },
            { time: '14:00', id: 'result200', name: 'နေ့လည်', color: 'text-green-600' },
            { time: '16:30', id: 'result430', name: 'ညနေ', color: 'text-purple-600' }
        ];

        let todayResults = {
            '09:30': null,
            '14:00': null,
            '16:30': null
        };

        function updateCurrentDate() {
            const now = new Date();
            const options = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                weekday: 'long'
            };
            document.getElementById('currentDate').textContent = now.toLocaleDateString('my-MM', options);
        }

        function generateRandomResult() {
            return String(Math.floor(Math.random() * 100)).padStart(2, '0');
        }

        function updateLotteryResults() {
            drawTimes.forEach(draw => {
                const resultElement = document.getElementById(draw.id);
                
                if (todayResults[draw.time]) {
                    // Display admin-set result with animation
                    resultElement.textContent = todayResults[draw.time];
                    resultElement.className = `text-3xl font-bold ${draw.color} animate-pulse`;
                    
                    // Add celebration effect
                    setTimeout(() => {
                        resultElement.classList.remove('animate-pulse');
                        resultElement.classList.add('animate-bounce-slow');
                    }, 1000);
                } else {
                    // Show waiting for admin to set result
                    resultElement.textContent = 'မထွက်သေး';
                    resultElement.className = 'text-3xl font-bold text-gray-400';
                }
            });
        }

        function updateNextDrawTime() {
            const now = new Date();
            const currentTime = now.getHours() * 100 + now.getMinutes();
            
            let nextDraw = null;
            
            for (let draw of drawTimes) {
                const drawTime = parseInt(draw.time.replace(':', ''));
                if (currentTime < drawTime) {
                    nextDraw = draw;
                    break;
                }
            }
            
            const nextDrawElement = document.getElementById('nextDrawTime');
            
            if (nextDraw) {
                const drawHour = Math.floor(parseInt(nextDraw.time.replace(':', '')) / 100);
                const drawMinute = parseInt(nextDraw.time.replace(':', '')) % 100;
                const drawDate = new Date();
                drawDate.setHours(drawHour, drawMinute, 0, 0);
                
                const timeDiff = drawDate - now;
                const hours = Math.floor(timeDiff / (1000 * 60 * 60));
                const minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));
                
                if (timeDiff > 0) {
                    nextDrawElement.textContent = `${nextDraw.name} ${nextDraw.time} (${hours}နာရီ ${minutes}မိနစ် ကျန်)`;
                } else {
                    nextDrawElement.textContent = `${nextDraw.name} ${nextDraw.time} - ထွက်နေပြီ`;
                }
            } else {
                // All draws for today are done
                nextDrawElement.textContent = 'ယနေ့ ထီများ အားလုံး ထွက်ပြီးပါပြီ';
            }
        }

        // Check for winning numbers
        function checkWinningNumbers() {
            const completedDraws = Object.entries(todayResults).filter(([time, result]) => result !== null);
            
            if (completedDraws.length === 0) return;
            
            // Check user's history for winning bets
            history.forEach(historyItem => {
                if (historyItem.status === 'အောင်မြင်ပါသည်') {
                    historyItem.bets.forEach(bet => {
                        completedDraws.forEach(([time, result]) => {
                            if (bet.number === result) {
                                // Mark as winner (this is just for display, real system would handle payouts)
                                bet.isWinner = true;
                                bet.winningDraw = time;
                            }
                        });
                    });
                }
            });
            
            updateHistoryDisplay();
        }

        // Admin lottery control functions
        function setLotteryResult(time, inputId) {
            const input = document.getElementById(inputId);
            const number = input.value.trim();
            
            // Validation
            if (!number || number.length !== 2 || isNaN(parseInt(number))) {
                alert('နံပါတ် ၂ လုံး ရိုက်ထည့်ပါ (00-99)');
                return;
            }
            
            const formattedNumber = String(parseInt(number)).padStart(2, '0');
            
            // Set the result
            todayResults[time] = formattedNumber;
            
            // Update display
            updateLotteryResults();
            checkWinningNumbers();
            
            // Clear input
            input.value = '';
            
            // Show success message
            const timeDisplay = time === '09:30' ? 'မနက် 9:30' : 
                               time === '14:00' ? 'နေ့လည် 2:00' : 'ညနေ 4:30';
            alert(`${timeDisplay} ထီရလဒ် ${formattedNumber} သတ်မှတ်ပြီးပါပြီ!`);
        }
        
        function clearAllResults() {
            if (confirm('ထီရလဒ် အားလုံး ရှင်းလင်းမှာ သေချာပါသလား?')) {
                todayResults = {
                    '09:30': null,
                    '14:00': null,
                    '16:30': null
                };
                
                // Reset display
                document.getElementById('result930').textContent = 'မထွက်သေး';
                document.getElementById('result930').className = 'text-3xl font-bold text-gray-400';
                
                document.getElementById('result200').textContent = 'မထွက်သေး';
                document.getElementById('result200').className = 'text-3xl font-bold text-gray-400';
                
                document.getElementById('result430').textContent = 'မထွက်သေး';
                document.getElementById('result430').className = 'text-3xl font-bold text-gray-400';
                
                // Clear admin inputs
                document.getElementById('admin930').value = '';
                document.getElementById('admin200').value = '';
                document.getElementById('admin430').value = '';
                
                alert('ထီရလဒ် အားလုံး ရှင်းလင်းပြီးပါပြီ!');
            }
        }

        // Auto-generate results for demo (disabled - now admin controlled)
        function simulateDrawResults() {
            // Disabled - results are now controlled by admin only
            // Admin must manually set results using the admin panel
        }

        // Initialize lottery system
        function initializeLotterySystem() {
            updateCurrentDate();
            simulateDrawResults(); // For demo
            updateLotteryResults();
            updateNextDrawTime();
            checkWinningNumbers();
            
            // Update every minute
            setInterval(() => {
                updateLotteryResults();
                updateNextDrawTime();
                checkWinningNumbers();
            }, 60000);
        }

        // Initialize
        setupFileUpload();
        updateBetDisplay();
        updateTotal();
        updatePayButton();
        updateHistoryDisplay();
        updateAdminHistoryDisplay();
        initializeLotterySystem();
        
        // Show login screen on startup
        showLoginScreen();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97e96df833b9893a',t:'MTc1Nzc4NTIyNS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

